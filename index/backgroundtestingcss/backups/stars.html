<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aurora Borealis Background Test</title>
    <style>
        /* General Setup */
        body {
            margin: 0;
            overflow: hidden; /* Prevent scrollbars when canvas is full screen */
            background-color: #000; /* Ensure a deep black background */
        }
        #background-canvas {
            display: block; /* Important to remove any default spacing */
            position: fixed; /* Fixes it to the viewport */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1; /* Puts it behind all other website content */
        }
    </style>
</head>
<body>

    <canvas id="background-canvas"></canvas>

    <script>
        const canvas = document.getElementById('background-canvas');
        const ctx = canvas.getContext('2d');
        let W, H;
        
        // --- Star Variables ---
        const maxStars = 300; // Number of stars
        let stars = [];
        const starSpeed = 0.05; // Base movement speed
        
        // --- Aurora Variables (Simplified for demonstration) ---
        // A simple array of colors for the aurora glow
        const auroraColors = ['#4caf50', '#8bc34a', '#03a9f4', '#2196f3', '#00bcd4', '#00e5ff'];
        let colorIndex = 0;
        let colorChangeTime = 0;
        const colorChangeInterval = 500; // Time in frames to transition color

        // Function to resize the canvas when the window resizes
        function resizeCanvas() {
            W = window.innerWidth;
            H = window.innerHeight;
            canvas.width = W;
            canvas.height = H;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        // --- Star Class/Setup ---
        class Star {
            constructor() {
                this.x = Math.random() * W;
                this.y = Math.random() * H;
                this.size = 1; // Fixed 1px size
                this.pulseOffset = Math.random() * Math.PI * 2; // Starting phase for pulsing
                this.opacity = Math.random() * 0.5 + 0.5; // Initial opacity
                this.speedX = (Math.random() - 0.5) * starSpeed;
                this.speedY = (Math.random() - 0.5) * starSpeed;
            }

            update() {
                // Random movement
                this.x += this.speedX;
                this.y += this.speedY;

                // Loop stars when they go off-screen
                if (this.x < 0) this.x = W;
                if (this.x > W) this.x = 0;
                if (this.y < 0) this.y = H;
                if (this.y > H) this.y = 0;

                // Pulsing effect: uses a sine wave for smooth, random pulsing
                const pulse = Math.sin(Date.now() / 500 + this.pulseOffset); // Time-based pulsing
                this.currentOpacity = this.opacity * (0.6 + 0.4 * pulse); // Varies between 0.2 and 1.0
            }

            draw() {
                ctx.fillStyle = `rgba(255, 255, 255, ${this.currentOpacity})`;
                ctx.fillRect(this.x, this.y, this.size, this.size);
            }
        }

        function initStars() {
            for (let i = 0; i < maxStars; i++) {
                stars.push(new Star());
            }
        }
        initStars();

        // --- Aurora Drawing Function ---
        function drawAurora() {
            // Simple color transition
            const currentColor = auroraColors[colorIndex];
            const nextColor = auroraColors[(colorIndex + 1) % auroraColors.length];
            
            colorChangeTime++;
            if (colorChangeTime > colorChangeInterval) {
                colorIndex = (colorIndex + 1) % auroraColors.length;
                colorChangeTime = 0;
            }
            
            const ratio = colorChangeTime / colorChangeInterval;
            
            // To create the smooth wavy effect, we use a loop with a sine wave for the height
            for (let x = 0; x < W; x += 2) { // x+=2 for better performance
                const waveHeight = Math.sin(x / 150 + Date.now() / 1000) * 50 + 75; // Creates a moving sine wave

                // Create a gradient for a soft, glowing light
                const gradient = ctx.createLinearGradient(x, 0, x, waveHeight * 2 + 100);
                
                // Simplified color mix for transition effect (not true gradient mixing, but works)
                const r1 = parseInt(currentColor.slice(1, 3), 16), g1 = parseInt(currentColor.slice(3, 5), 16), b1 = parseInt(currentColor.slice(5, 7), 16);
                const r2 = parseInt(nextColor.slice(1, 3), 16), g2 = parseInt(nextColor.slice(3, 5), 16), b2 = parseInt(nextColor.slice(5, 7), 16);
                
                const r = Math.round(r1 + (r2 - r1) * ratio);
                const g = Math.round(g1 + (g2 - g1) * ratio);
                const b = Math.round(b1 + (b2 - b1) * ratio);
                
                const mixedColor = `rgb(${r}, ${g}, ${b})`;
                
                gradient.addColorStop(0, `rgba(${r}, ${g}, ${b}, 0.6)`);
                gradient.addColorStop(0.5, `rgba(${r}, ${g}, ${b}, 0.2)`);
                gradient.addColorStop(1, 'rgba(0, 0, 0, 0)');
                
                ctx.fillStyle = gradient;
                
                // Draw the vertical line segment of the aurora
                ctx.fillRect(x, H - waveHeight, 2, waveHeight * 2); 
            }
        }

        // --- Main Animation Loop ---
        function animate() {
            // Clear the canvas each frame
            ctx.clearRect(0, 0, W, H);
            
            // 1. Draw the Northern Lights effect
            drawAurora();

            // 2. Draw the Stars
            stars.forEach(star => {
                star.update();
                star.draw();
            });

            requestAnimationFrame(animate);
        }

        animate(); // Start the animation
    </script>
</body>
</html>